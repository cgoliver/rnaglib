# Data README


## Graph Format

Each graph contains structure information for one model of a PDB entry
containing at least one RNA chain.

Graphs are stored in `JSON` node-link format which can be loaded by
[networkx](https://networkx.org/documentation/stable/reference/readwrite/generated/networkx.readwrite.json_graph.node_link_data.html#networkx.readwrite.json_graph.node_link_data).

All data comes from the output of `x3dna-dssr` which can be downloaded
[here](https://x3dna.org/) and our custom interface extraction tools.


Data sources to integrate:

* DSSP for protein structure info
* GO annotations
* RFAM annotations
* PDB metadata

### Creating a graph

TODO: will need to make a script that calls the DSSR annotator and Jonathan's
scripts.

### Loading a graph

Graphs are dumped as JSONs in the node-link format.

```python
import json
from networkx.readwrite.json_graph import node_link_graph

G  = node_link_graph(open('path/to/graph', 'r'))
```

### Graph

TODO

### Nodes 

#### Node IDs

Node IDs are strings in the form `[pdb id].[chain name].[residue number]`.

#### Node Data

To access node data dictionary:

```python
G.nodes[<node_id>]
```
These are the keys in the node data dictionary: 

* `'index'`: (int), relative index along chain starting at 1 (e.g. `1`)
* `'index_chain'`: (int) 26 (e.g. `26`)
* `'chain_name'`: (str), name of chain. (e.g. `A`)
* `'nt_resnum'`: (int), residue number according to PDB. (e.g. `101`)
* `'nt_name'`: (str), nucleotide name  (e.g. `G`)
* `'nt_code'`: (str), (e.g. `'U'`)
* `'nt_id'`: (str) unique nucleotide ID generated by DSSR. `<chain name>.<nt name><nt_resnum>` (e.g. `'A.U42'`),
* `'nt_type'`: (str) molecule type of residue (e.g. `'RNA'`)
* `'dbn':` (str) dot-bracket notation for the residue (e.g. `')'`)
* `'summary'`: (str) additional residue info (e.g. `"anti,~C3'-endo,BI,canonical,non-pair-contact,helix,stem,coaxial-stack"`)
* `'alpha'`: (float) base angle in degrees `[-180, 180]`.
* `'beta'`: (float)  base angle
* `'gamma'`: (float) base angle 
* `'delta'`: (float) base angle 
* `'epsilon'`: (float)
* `'zeta'`: (float) 
* `'epsilon_zeta'`: (float)
* `'bb_type':` (str) Backbone type 'BI',
* `'chi'`: (float) 
* `'glyco_bond'`: str (e.g.   `'anti'`
* `'C5prime_xyz': (list), 5' Carbon xyz coordinates (e.g.  `[-1.343, 8.453, 1.288]`)
* `'P_xyz'`: (list) Phosphate coordinates.
* `'form'`: (str) (e.g. `'A'`)
* `'ssZp'`: (float)  (e.g. `4.41`),
* `'Dp'`: (float) (e.g. `4.404`)
* `'splay_angle'`: (float)  (e.g. `21.6`),
* `'splay_distance'`: (float) (e.g. `3.612`)
* `'splay_ratio':` (float) (e.g. `0.199`)
* `'eta'`: (float) (e.g. `169.652`),
* `'theta':` -167.457,
* `'eta_prime'`: (float) (e.g. `-176.189`)
* `'theta_prime':` (float) (e.g. `-167.27`)
* `'eta_base'`: (float)   (e.g. `-135.681`)
* `'theta_base'`: (float) (e.g. `-141.003`)
* `'v0'`: (float) (e.g `8.194`)
* `'v1'`: (float) (e.g. `-28.393`),
* `'v2'`: (float) 
* `'v3'`: (float) 
* `'v4'`: (float) 
* `'amplitude'`: (float)
* `'phase_angle'`: (float) 
* `'puckering'`: (str) (e.g. `"C3'-endo"`)
* `'sugar_class':` (str) (e.g. `"~C3'-endo"`)
* `'bin'`: (str) (e.g. `'33t'`)
* `'cluster'`: (str) (e.g. `'1c'`),
* `'suiteness'`: (float) 
* `'filter_rmsd'`: (float)
* `'frame':` (dict)  e.g. (`{'rmsd': 0.006, 'origin': [-4.856, 8.564, -1.171], 'x_axis': [0.922, 0.386, -0.006], 'y_axis': [0.098, -0.25, -0.963], 'z_axis': [-0.374, 0.888, -0.269], 'quaternion': [0.592, -0.781, -0.155, 0.122]}`
* `'sse'`: (dict) Secondary structure info (e.g. residue inside third hairpin `{'sse': 'hairpin-3'}`)
* `'binding_protein'`: (dict) RNA-Protein interface. If no interface found, `None`. Else, dictionary (e.g. `{'nt-aa': 'C-arg', 'nt': 'A.C37', 'aa': 'A.ARG47', 'Tdst': '6.62', 'Rdst': '-114.00', 'Tx': '-1.15', 'Ty': '1.89', 'Tz': '6.23', 'Rx': '-53.57', 'Ry': '19.41', 'Rz': '-103.42'}`)
* `binding_ion`: (string) molecule ID of ion if residue is at a binding site (otherwise `None`) (e.g. `'Ca'`)
* `binding_small-molecule`: (string) molecule ID of small molecule if residue is at a binding site (otherwise `None`) (e.g. `'Ca'`)


### Edge data

